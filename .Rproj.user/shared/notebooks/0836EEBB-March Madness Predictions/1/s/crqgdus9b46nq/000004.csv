"0","library(tidyverse)"
"0","library(readxl)"
"0","library(shiny)"
"0",""
"0","import1 <- read_csv('2021_sports_reference.csv') %>%"
"0","  mutate(conference = paste(W_conf, ""-"", L_conf)) %>%"
"0","  mutate(record = paste(Wins, ""-"", Losses)) %>%"
"0","  mutate(home = paste(W_home, ""-"", L_home)) %>%"
"0","  mutate(away = paste(W_away, ""-"", L_away)) %>%"
"0","  mutate(school = tolower(School_trim)) %>%"
"0","  mutate(`3pg` = `3P`/Games) %>%"
"0","  mutate(FTpg = round(FT/Games)) %>%"
"0","  mutate(OREBpg = round(ORB/Games)) %>%"
"0","  mutate(REBpg = round(TRB/Games)) %>%"
"0","  mutate(ASTpg = round(AST/Games)) %>%"
"0","  mutate(STLpg = round(STL/Games)) %>%"
"0","  mutate(BLKpg = round(BLK/Games))"
"2","
[36m--[39m [1m[1mColumn specification[1m[22m [36m--------------------------------------------------[39m
cols(
  .default = col_double(),
  School_trim = [31mcol_character()[39m,
  `68.77670191` = [33mcol_logical()[39m
)
[36mi[39m Use [38;5;235m[48;5;253m[38;5;235m[48;5;253m`spec()`[48;5;253m[38;5;235m[49m[39m for the full column specifications.

"
"0","stats <- import1 %>%"
"0","  select(school, record, SimpleRatingSystem, StrengthOfSchedule, "
"0","         home, away, conference, Points_made, 'FG%', FGA, FTA, 'FT%', ORB, TOV, OER, DER, PosPG) %>%"
"0","  arrange(school)"
"0",""
"0","import2 <- read_excel('ncaa basketball 2020-21.xlsx', sheet = 'Sheet1') %>%"
"0","  mutate(school = tolower(Team)) "
"0","import2$school <- gsub(""washingtonu"", ""washington"", import2$school)"
"0","import2$school <- gsub(""norfolkst"", ""norfolkstate"", import2$school)"
"0","import2$school <- gsub(""appalachianst"", ""appalachianstate"", import2$school)"
"0","import2$school <- gsub(""calsantabarbara"", ""uc-santabarbara"", import2$school)"
"0","import2$school <- gsub(""calsantabarb"", ""uc-santabarbara"", import2$school)"
"0","import2$school <- gsub(""usc"", ""southerncalifornia"", import2$school)"
"0","import2$school <- gsub(""e.washington"", ""easternwashington"", import2$school)"
"0","import2$school <- gsub(""vacommonwealth"", ""virginiacommonwealth"", import2$school) "
"0","import2$school <- gsub(""loyolachicago"", ""loyola(il)"", import2$school)"
"0","import2$school <- gsub(""houstonu"", ""houston"", import2$school)"
"0","import2$school <- gsub(""mountstmarys"", ""mountst.mary's"", import2$school)"
"0","import2$school <- gsub(""lsu"", ""louisianastate"", import2$school)"
"0","import2$school <- gsub(""ncgreensboro"", ""northcarolina-greensboro"", import2$school)"
"0","import2$school <- gsub(""byu"", ""brighamyoung"", import2$school)"
"0",""
"0","lookup1 <- import2 %>%"
"0","  select(school, Final, Rot, Date) %>%"
"0","  mutate(opponent_rot = ifelse(Rot %% 2 == 0, Rot - 1, Rot + 1) ) %>%"
"0","  mutate(game_date = paste(ifelse(sapply(Date,nchar)==3,'2021','2020'),Date, sep = '-'))"
"0","lookup2 <- import2 %>%"
"0","  mutate(opponent_rot = Rot) %>% "
"0","  mutate(opponent_school = school) %>%"
"0","  mutate(opponent_final = Final) %>%"
"0","  select(opponent_rot, opponent_school, Date, opponent_final) %>%"
"0","  mutate(game_date = paste(ifelse(sapply(Date,nchar)==3,'2021','2020'),Date, sep = '-'))"
"0","games <- merge(lookup1, lookup2) %>%"
"0","  select(game_date, school, Final, opponent_school, opponent_final) %>%"
"0","  mutate(win_or_loss = ifelse(Final > opponent_final, 'W', 'L'))"
"0","rm(import1, import2, lookup1, lookup2)"
"0",""
"0",""
"0","# matchup"
"0","compare <- function(team1, team2){"
"0","  team1_stats <- stats %>%"
"0","    filter(school == team1)"
"0","  team2_stats <- stats %>%"
"0","    filter(school == team2)"
"0","  x <- rbind(team1_stats, team2_stats)"
"0","  x"
"0","}"
"0","# projection"
"0","score <- function(team1, team2){"
"0","  team1oer <- stats[which(tolower(stats$school) == team1), 'OER'] "
"0","  team1der <- stats[which(tolower(stats$school) == team1), 'DER'] "
"0","  team1pospg <- stats[which(tolower(stats$school) == team1), 'PosPG']"
"0","  team2oer <- stats[which(tolower(stats$school) == team2), 'OER']"
"0","  team2der <- stats[which(tolower(stats$school) == team2), 'DER']"
"0","  team2pospg <- stats[which(tolower(stats$school) == team2), 'PosPG']"
"0","  gamePace <- ((team1pospg*team2pospg)/68.8)"
"0","  team1PPP <- (team1oer*team2der)/100"
"0","  team2PPP <- (team2oer*team1der)/100"
"0","  team1score <- (team1PPP*gamePace)/100"
"0","  team2score <- (team2PPP*gamePace)/100"
"0","  cat(""Team 1 Projected Score: "", team1score[1,1], ""\n"")"
"0","  cat(""Team 2 Projected Score: "", team2score[1,1])"
"0","}"
"0",""
"0","# games"
"0","matchup <- function(team1, team2){"
"0","  matchups <- games %>%"
"0","    filter(school == team1, opponent_school == team2) %>%"
"0","    select(game_date, school, Final, opponent_final, opponent_school, win_or_loss)"
"0","  matchups"
"0","}"
"0",""
"0","# last ten matches"
"0","games_last_ten <- function(team) {"
"0","  x <- games %>%"
"0","    filter(game_date > '2020-1231') %>%"
"0","    filter(school == team) %>%"
"0","    arrange(desc(game_date)) %>%"
"0","    top_n(10,game_date)   # slice(1:10) also works"
"0","}"
